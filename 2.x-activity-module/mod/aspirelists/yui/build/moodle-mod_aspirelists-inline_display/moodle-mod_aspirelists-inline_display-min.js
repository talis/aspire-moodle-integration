YUI.add("moodle-mod_aspirelists-inline_display",function(e,t){M.mod_aspirelists=M.mod_aspirelists||{},NS=M.mod_aspirelists.inline_display={},NS.init_view=function(t,n){e.delegate("click",this.toggle_inline_list,e.config.doc,".aspirelists_inline_readings_toggle .activityinstance a",this),e.on("domready",this.resize_embedded_lists),e.on("domready",this.ExpandedInlineIFramesLoader.startQueue),e.on("scroll",this.ExpandedInlineIFramesLoader.loadIfIframeInViewport),this.accordionOpen=t,this.accordionClosed=n},NS.toggleAccordionIndicator=function(e,t){e.ancestor(".aspirelists").all("span.aspirelists_inline_accordion").each(function(e){e.setHTML(t)})},NS.toggle_inline_list=function(e){e.preventDefault();var t=e.target.ancestor(".aspirelists");t&&t.all(".aspirelists_inline_list").each(function(e){if(e.getStyle("display")==="none"){e.show();if(e.getAttribute("src")===""){var t=e.getData("intended-src");e.setAttribute("src",t)}NS.toggleAccordionIndicator(e,NS.accordionOpen)}else e.hide(),NS.toggleAccordionIndicator(e,NS.accordionClosed)})},NS.resize_embedded_lists=function(t){e.all(".aspirelists_inline_list").each(function(e){var t=e.ancestor(".aspirelists").get("offsetWidth"),n=e.ancestor(".aspirelists").getComputedStyle("margin"),r=e.ancestor(".aspirelists").getComputedStyle("padding-left");n&&(t-=parseFloat(n,10)*2),r&&(t-=parseFloat(r,10)*2);var i=e.ancestor(".mod-indent-outer");if(i){var s=i.getComputedStyle("padding-left"),o=e.getComputedStyle("margin-left");o&&(t-=parseFloat(o,10)*2),s&&(t-=parseFloat(s,10)*2)}e.setAttribute("width",t)})},NS.ExpandedInlineIFramesLoader=function(){var t,n={iframeQueue:[],inline_display_delay:1e3,viewport_hover_delay:1e3,loadIfIframeInViewport:function(){for(var n=0;n<t.iframeQueue.length;n++){var r=t.iframeQueue[n].element;if(e.DOM.inViewportRegion(r.getDOMNode())){var i=t.iframeQueue[n].src;window.setTimeout(function(t,n,r){return function(){e.DOM.inViewportRegion(t.getDOMNode())&&r(n,t)}}(r,i,t.populateIFrame),t.viewport_hover_delay)}}},add_to_iframe_load_queue:function(e,t){this.iframeQueue.push({src:e,element:t})},populateIFrame:function(e,t){t.getAttribute("src")===""&&t.setAttribute("src",e)},processNextInQueue:function(){var e=t.iframeQueue.shift();if(e===undefined)return;this.populateIFrame(e.src,e.element),window.setTimeout(function(){t.processNextInQueue()},t.inline_display_delay)},startQueue:function(){e.all(".aspirelists_inline_list").each(function(e){var n=e.getData("intended-src");e.getStyle("display")!=="none"&&t.add_to_iframe_load_queue(n,e)}),t.processNextInQueue()},init:function(){t=this}};return n.init(),n}()},"@VERSION@",{requires:["base","node","event","event-delegate"]});
